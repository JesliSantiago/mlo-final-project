c:\Users\Jesli's Laptop\Desktop\Acads\MLO\mlo-final-project\code\model.py:35: FutureWarning: The default value of regex will change from True to False in a future version.
  self.df_train['Poem'] = self.df_train['Poem'].str.replace('shade.When', 'shade. When')
c:\Users\Jesli's Laptop\Desktop\Acads\MLO\mlo-final-project\code\model.py:36: FutureWarning: The default value of regex will change from True to False in a future version.
  self.df_train['Poem'] = self.df_train['Poem'].str.replace('afraid.Now', 'afraid. Now')
c:\Users\Jesli's Laptop\Desktop\Acads\MLO\mlo-final-project\code\model.py:38: FutureWarning: The default value of regex will change from True to False in a future version.
  self.df_train['Poem'] = self.df_train['Poem'].str.replace('afraid.Now,', 'afraid. Now,')
c:\Users\Jesli's Laptop\Desktop\Acads\MLO\mlo-final-project\code\model.py:39: FutureWarning: The default value of regex will change from True to False in a future version.
  self.df_train['Poem'] = self.df_train['Poem'].str.replace('Big Game.Bigger', 'Big Game. Bigger')
[nltk_data] Downloading package stopwords to C:\Users\Jesli's
[nltk_data]     Laptop\AppData\Roaming\nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
Epoch 1/50
21/21 [==============================] - 1s 23ms/step - loss: 1.3669 - acc: 0.3019 - val_loss: 1.3395 - val_acc: 0.3750
Epoch 2/50
21/21 [==============================] - 0s 14ms/step - loss: 1.1901 - acc: 0.5067 - val_loss: 1.3274 - val_acc: 0.3929
Epoch 3/50
21/21 [==============================] - 0s 14ms/step - loss: 0.9930 - acc: 0.6024 - val_loss: 1.5247 - val_acc: 0.4345
Epoch 4/50
21/21 [==============================] - 0s 14ms/step - loss: 0.8249 - acc: 0.6726 - val_loss: 1.4533 - val_acc: 0.4107
Epoch 5/50
21/21 [==============================] - 0s 13ms/step - loss: 0.6661 - acc: 0.7265 - val_loss: 1.6443 - val_acc: 0.4286
Epoch 6/50
21/21 [==============================] - 0s 13ms/step - loss: 0.6221 - acc: 0.7698 - val_loss: 1.6890 - val_acc: 0.4286
Epoch 7/50
21/21 [==============================] - 0s 14ms/step - loss: 0.5452 - acc: 0.7922 - val_loss: 1.9152 - val_acc: 0.3988
Epoch 8/50
21/21 [==============================] - 0s 13ms/step - loss: 0.5463 - acc: 0.7937 - val_loss: 1.9902 - val_acc: 0.4107
Epoch 9/50
21/21 [==============================] - 0s 14ms/step - loss: 0.4384 - acc: 0.8236 - val_loss: 2.1034 - val_acc: 0.4226
Epoch 10/50
21/21 [==============================] - 0s 15ms/step - loss: 0.4161 - acc: 0.8371 - val_loss: 2.2713 - val_acc: 0.3929
Epoch 11/50
21/21 [==============================] - 0s 13ms/step - loss: 0.4026 - acc: 0.8371 - val_loss: 2.3197 - val_acc: 0.3988
Epoch 12/50
21/21 [==============================] - 0s 14ms/step - loss: 0.3759 - acc: 0.8460 - val_loss: 2.7054 - val_acc: 0.3929
Epoch 13/50
21/21 [==============================] - 0s 14ms/step - loss: 0.3446 - acc: 0.8744 - val_loss: 2.6677 - val_acc: 0.3690
Epoch 14/50
21/21 [==============================] - 0s 13ms/step - loss: 0.3197 - acc: 0.8774 - val_loss: 2.7849 - val_acc: 0.3929
Epoch 15/50
21/21 [==============================] - 0s 13ms/step - loss: 0.3469 - acc: 0.8729 - val_loss: 3.0667 - val_acc: 0.3571
Epoch 16/50
21/21 [==============================] - 0s 13ms/step - loss: 0.3039 - acc: 0.8849 - val_loss: 3.0257 - val_acc: 0.3571
Epoch 17/50
21/21 [==============================] - 0s 14ms/step - loss: 0.3144 - acc: 0.8849 - val_loss: 3.0691 - val_acc: 0.3810
Epoch 18/50
21/21 [==============================] - 0s 14ms/step - loss: 0.3324 - acc: 0.8774 - val_loss: 3.2325 - val_acc: 0.3333
Epoch 19/50
21/21 [==============================] - 0s 13ms/step - loss: 0.2902 - acc: 0.8939 - val_loss: 3.2900 - val_acc: 0.3750
Epoch 20/50
21/21 [==============================] - 0s 14ms/step - loss: 0.3379 - acc: 0.8610 - val_loss: 3.4308 - val_acc: 0.3631
Epoch 21/50
21/21 [==============================] - 0s 16ms/step - loss: 0.2797 - acc: 0.9013 - val_loss: 3.4659 - val_acc: 0.3810
Epoch 22/50
21/21 [==============================] - 0s 15ms/step - loss: 0.2631 - acc: 0.8969 - val_loss: 3.4606 - val_acc: 0.3750
Epoch 23/50
21/21 [==============================] - 0s 15ms/step - loss: 0.2590 - acc: 0.9013 - val_loss: 3.6520 - val_acc: 0.3750
Epoch 24/50
21/21 [==============================] - 0s 12ms/step - loss: 0.3120 - acc: 0.8939 - val_loss: 3.5879 - val_acc: 0.3869
Epoch 25/50
21/21 [==============================] - 0s 12ms/step - loss: 0.2286 - acc: 0.9268 - val_loss: 3.6262 - val_acc: 0.3631
Epoch 26/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2217 - acc: 0.9163 - val_loss: 3.7409 - val_acc: 0.3988
Epoch 27/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2375 - acc: 0.9103 - val_loss: 3.7447 - val_acc: 0.3810
Epoch 28/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2193 - acc: 0.9238 - val_loss: 3.8851 - val_acc: 0.3869
Epoch 29/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2739 - acc: 0.9118 - val_loss: 4.1517 - val_acc: 0.3810
Epoch 30/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2616 - acc: 0.9133 - val_loss: 4.0855 - val_acc: 0.3750
Epoch 31/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2163 - acc: 0.9283 - val_loss: 3.9601 - val_acc: 0.3571
Epoch 32/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2760 - acc: 0.9193 - val_loss: 4.0254 - val_acc: 0.3810
Epoch 33/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2544 - acc: 0.9043 - val_loss: 3.9876 - val_acc: 0.3988
Epoch 34/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2371 - acc: 0.9118 - val_loss: 3.9418 - val_acc: 0.3810
Epoch 35/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2335 - acc: 0.9268 - val_loss: 4.0555 - val_acc: 0.3690
Epoch 36/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2406 - acc: 0.9193 - val_loss: 4.2716 - val_acc: 0.3452
Epoch 37/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2478 - acc: 0.9223 - val_loss: 4.2580 - val_acc: 0.3988
Epoch 38/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2208 - acc: 0.9178 - val_loss: 3.9703 - val_acc: 0.3690
Epoch 39/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2763 - acc: 0.9013 - val_loss: 4.0689 - val_acc: 0.3810
Epoch 40/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2764 - acc: 0.9163 - val_loss: 4.1023 - val_acc: 0.3810
Epoch 41/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2240 - acc: 0.9283 - val_loss: 4.2865 - val_acc: 0.3929
Epoch 42/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2465 - acc: 0.9148 - val_loss: 4.1456 - val_acc: 0.3988
Epoch 43/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2261 - acc: 0.9208 - val_loss: 4.2208 - val_acc: 0.3869
Epoch 44/50
21/21 [==============================] - 0s 12ms/step - loss: 0.2224 - acc: 0.9268 - val_loss: 4.2524 - val_acc: 0.3452
Epoch 45/50
21/21 [==============================] - 0s 11ms/step - loss: 0.1847 - acc: 0.9357 - val_loss: 4.1686 - val_acc: 0.3988
Epoch 46/50
21/21 [==============================] - 0s 12ms/step - loss: 0.2118 - acc: 0.9297 - val_loss: 4.2604 - val_acc: 0.3810
Epoch 47/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2234 - acc: 0.9223 - val_loss: 4.3018 - val_acc: 0.3869
Epoch 48/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2740 - acc: 0.9208 - val_loss: 4.4182 - val_acc: 0.3571
Epoch 49/50
21/21 [==============================] - 0s 11ms/step - loss: 0.2327 - acc: 0.9148 - val_loss: 4.3136 - val_acc: 0.3690
Epoch 50/50
 1/21 [>.............................] - ETA: 0s - loss: 0.1385 - acc: 0.9688
Traceback (most recent call last):
  File "C:\Users\Jesli's Laptop\AppData\Local\Temp\ipykernel_36588\2502037418.py", line 27, in hyperparam_search
    _model.test(embd_dim=embedding_dim, epochs=epochs, lr=learning_rate, optimizer=optimizer)

21/21 [==============================] - 0s 11ms/step - loss: 0.2250 - acc: 0.9238 - val_loss: 4.1352 - val_acc: 0.4048