c:\Users\Jesli's Laptop\Desktop\Acads\MLO\mlo-final-project\code\model.py:51: FutureWarning: The default value of regex will change from True to False in a future version.
  self.df_train['Poem'] = self.df_train['Poem'].str.replace('shade.When', 'shade. When')
c:\Users\Jesli's Laptop\Desktop\Acads\MLO\mlo-final-project\code\model.py:52: FutureWarning: The default value of regex will change from True to False in a future version.
  self.df_train['Poem'] = self.df_train['Poem'].str.replace('afraid.Now', 'afraid. Now')
c:\Users\Jesli's Laptop\Desktop\Acads\MLO\mlo-final-project\code\model.py:54: FutureWarning: The default value of regex will change from True to False in a future version.
  self.df_train['Poem'] = self.df_train['Poem'].str.replace('afraid.Now,', 'afraid. Now,')
c:\Users\Jesli's Laptop\Desktop\Acads\MLO\mlo-final-project\code\model.py:55: FutureWarning: The default value of regex will change from True to False in a future version.
  self.df_train['Poem'] = self.df_train['Poem'].str.replace('Big Game.Bigger', 'Big Game. Bigger')
[nltk_data] Downloading package stopwords to C:\Users\Jesli's
[nltk_data]     Laptop\AppData\Roaming\nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
Epoch 1/50
21/21 [==============================] - 1s 19ms/step - loss: 1.3810 - acc: 0.2616 - val_loss: 1.3762 - val_acc: 0.2738
Epoch 2/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3714 - acc: 0.2945 - val_loss: 1.3726 - val_acc: 0.2560
Epoch 3/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3689 - acc: 0.2900 - val_loss: 1.3714 - val_acc: 0.2440
Epoch 4/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3671 - acc: 0.2870 - val_loss: 1.3708 - val_acc: 0.2440
Epoch 5/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3654 - acc: 0.2945 - val_loss: 1.3705 - val_acc: 0.2440
Epoch 6/50
21/21 [==============================] - 0s 11ms/step - loss: 1.3646 - acc: 0.2990 - val_loss: 1.3704 - val_acc: 0.2440
Epoch 7/50
21/21 [==============================] - 0s 10ms/step - loss: 1.3636 - acc: 0.2990 - val_loss: 1.3703 - val_acc: 0.2440
Epoch 8/50
21/21 [==============================] - 0s 10ms/step - loss: 1.3641 - acc: 0.2990 - val_loss: 1.3707 - val_acc: 0.2440
Epoch 9/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3633 - acc: 0.2975 - val_loss: 1.3705 - val_acc: 0.2440
Epoch 10/50
21/21 [==============================] - 0s 17ms/step - loss: 1.3629 - acc: 0.2960 - val_loss: 1.3703 - val_acc: 0.2440
Epoch 11/50
21/21 [==============================] - 0s 14ms/step - loss: 1.3623 - acc: 0.2960 - val_loss: 1.3700 - val_acc: 0.2440
Epoch 12/50
21/21 [==============================] - 0s 14ms/step - loss: 1.3625 - acc: 0.3019 - val_loss: 1.3695 - val_acc: 0.2440
Epoch 13/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3618 - acc: 0.2915 - val_loss: 1.3692 - val_acc: 0.2440
Epoch 14/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3619 - acc: 0.2945 - val_loss: 1.3695 - val_acc: 0.2440
Epoch 15/50
21/21 [==============================] - 0s 10ms/step - loss: 1.3613 - acc: 0.3034 - val_loss: 1.3695 - val_acc: 0.2500
Epoch 16/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3621 - acc: 0.2885 - val_loss: 1.3693 - val_acc: 0.2500
Epoch 17/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3611 - acc: 0.3094 - val_loss: 1.3689 - val_acc: 0.2560
Epoch 18/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3612 - acc: 0.3049 - val_loss: 1.3686 - val_acc: 0.2560
Epoch 19/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3603 - acc: 0.3094 - val_loss: 1.3691 - val_acc: 0.2560
Epoch 20/50
21/21 [==============================] - 0s 15ms/step - loss: 1.3609 - acc: 0.3019 - val_loss: 1.3689 - val_acc: 0.2560
Epoch 21/50
21/21 [==============================] - 0s 14ms/step - loss: 1.3610 - acc: 0.2945 - val_loss: 1.3687 - val_acc: 0.2560
Epoch 22/50
21/21 [==============================] - 0s 11ms/step - loss: 1.3609 - acc: 0.3004 - val_loss: 1.3687 - val_acc: 0.2560
Epoch 23/50
21/21 [==============================] - 0s 10ms/step - loss: 1.3611 - acc: 0.2855 - val_loss: 1.3685 - val_acc: 0.2560
Epoch 24/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3597 - acc: 0.3064 - val_loss: 1.3684 - val_acc: 0.2679
Epoch 25/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3606 - acc: 0.2990 - val_loss: 1.3681 - val_acc: 0.2679
Epoch 26/50
21/21 [==============================] - 0s 10ms/step - loss: 1.3600 - acc: 0.3049 - val_loss: 1.3677 - val_acc: 0.2679
Epoch 27/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3582 - acc: 0.3079 - val_loss: 1.3678 - val_acc: 0.2679
Epoch 28/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3603 - acc: 0.2900 - val_loss: 1.3673 - val_acc: 0.2679
Epoch 29/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3589 - acc: 0.3004 - val_loss: 1.3675 - val_acc: 0.2679
Epoch 30/50
21/21 [==============================] - 0s 12ms/step - loss: 1.3586 - acc: 0.3109 - val_loss: 1.3664 - val_acc: 0.2798
Epoch 31/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3584 - acc: 0.2960 - val_loss: 1.3661 - val_acc: 0.2798
Epoch 32/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3597 - acc: 0.2855 - val_loss: 1.3665 - val_acc: 0.2798
Epoch 33/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3595 - acc: 0.3034 - val_loss: 1.3667 - val_acc: 0.2619
Epoch 34/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3576 - acc: 0.3064 - val_loss: 1.3662 - val_acc: 0.2738
Epoch 35/50
21/21 [==============================] - 0s 13ms/step - loss: 1.3592 - acc: 0.3019 - val_loss: 1.3659 - val_acc: 0.2798
Epoch 36/50
21/21 [==============================] - 0s 14ms/step - loss: 1.3585 - acc: 0.3034 - val_loss: 1.3655 - val_acc: 0.2857
Epoch 37/50
21/21 [==============================] - 0s 13ms/step - loss: 1.3568 - acc: 0.3034 - val_loss: 1.3652 - val_acc: 0.2798
Epoch 38/50
21/21 [==============================] - 0s 10ms/step - loss: 1.3585 - acc: 0.3019 - val_loss: 1.3654 - val_acc: 0.2976
Epoch 39/50
21/21 [==============================] - 0s 14ms/step - loss: 1.3568 - acc: 0.3079 - val_loss: 1.3653 - val_acc: 0.2738
Epoch 40/50
21/21 [==============================] - 0s 13ms/step - loss: 1.3573 - acc: 0.3079 - val_loss: 1.3648 - val_acc: 0.2976
Epoch 41/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3576 - acc: 0.2915 - val_loss: 1.3644 - val_acc: 0.2857
Epoch 42/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3582 - acc: 0.2990 - val_loss: 1.3646 - val_acc: 0.2917
Epoch 43/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3566 - acc: 0.2915 - val_loss: 1.3644 - val_acc: 0.2917
Epoch 44/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3575 - acc: 0.3004 - val_loss: 1.3636 - val_acc: 0.2857
Epoch 45/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3577 - acc: 0.3034 - val_loss: 1.3634 - val_acc: 0.2798
Epoch 46/50
21/21 [==============================] - 0s 9ms/step - loss: 1.3570 - acc: 0.3079 - val_loss: 1.3635 - val_acc: 0.2917
Epoch 47/50
21/21 [==============================] - 0s 10ms/step - loss: 1.3586 - acc: 0.3049 - val_loss: 1.3638 - val_acc: 0.2857
Epoch 48/50
21/21 [==============================] - 0s 10ms/step - loss: 1.3565 - acc: 0.2975 - val_loss: 1.3642 - val_acc: 0.2738
Epoch 49/50
21/21 [==============================] - 0s 12ms/step - loss: 1.3565 - acc: 0.3004 - val_loss: 1.3641 - val_acc: 0.2798
Epoch 50/50
12/21 [================>.............] - ETA: 0s - loss: 1.3477 - acc: 0.3021
Traceback (most recent call last):
  File "C:\Users\Jesli's Laptop\AppData\Local\Temp\ipykernel_4508\3043076251.py", line 19, in hyperparam_search
    _model.train(embd_dim=embedding_dim, epochs=epochs, lr=learning_rate, optimizer=optimizer)
  File "c:\Users\Jesli's Laptop\Desktop\Acads\MLO\mlo-final-project\code\model.py", line 132, in train
    self._save(embd_dim, lr, optimizer)
  File "c:\Users\Jesli's Laptop\Desktop\Acads\MLO\mlo-final-project\code\model.py", line 96, in _save
    self.model.save_pretrained(f"../model_weights/{emb}_{lr:.2f}_{optim}_acc_{max(self.trained_model.history['val_acc'])}_pt.h5")

21/21 [==============================] - 0s 13ms/step - loss: 1.3551 - acc: 0.2810 - val_loss: 1.3637 - val_acc: 0.2857